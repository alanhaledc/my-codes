<!-- 图片懒加载实现 -->
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>lazy loading</title>
    <style>
      .image-item {
        display: block;
        margin-bottom: 50px;
        height: 200px; /* 一定记得设置图片高度 */
      }
    </style>
  </head>
  <body>
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <img class="image-item" data-src="http://src.haledeng.com/simple-vue.png" />
    <script>
      var viewHeight =
        window.innerHeight || document.documentElement.clientHeight; //获取可视区高度

      function lazyload() {
        var images = document.querySelectorAll("img[data-src]"); // 获取全部图片元素

        for (var i = 0; i < images.length; i++) {
          var image = images[i];
          var rect = image.getBoundingClientRect(); // 获得元素相对于浏览器视窗的位置

          if (rect.bottom >= 0 && rect.top < viewHeight) {
            image.src = image.dataset.src; // data 的数据赋值给 src
            image.removeAttribute("data-src"); //移除属性，下次不再遍历
          }
        }
      }

      lazyload(); // 刚开始还没滚动屏幕时，要先触发一次函数，初始化页面前面的图片
      window.addEventListener("scroll", lazyload); // 绑定窗口滚动事件
    </script>
  </body>
</html>
